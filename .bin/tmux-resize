#!/bin/bash

# Expected width & height values:
# 1440 x 900:  204 x 59
# 2560 x 1440: 364 x 101

width="$(tmux display-message -p '#{window_width}')"
height="$(tmux display-message -p '#{window_height}')"
panes="$(tmux display-message -p '#{window_panes}')"

native1="34f7,204x59,0,0,155"
native2="4c20,204x59,0,0{102x59,0,0,133,101x59,103,0,134}"
native3="e39a,204x59,0,0{102x59,0,0,133,101x59,103,0[101x29,103,0,134,101x29,103,30,138]}"
native4="6616,204x59,0,0{102x59,0,0[102x29,0,0,133,102x29,0,30,139],101x59,103,0[101x29,103,0,134,101x29,103,30,138]}"
native5="8422,204x59,0,0{102x59,0,0[102x29,0,0,133,102x29,0,30,139],101x59,103,0[101x29,103,0,134,101x14,103,30,138,101x14,103,45,140]}"
native6="e02f,204x59,0,0{102x59,0,0[102x29,0,0,155,102x29,0,30,157],101x59,103,0[101x14,103,0,156,101x14,103,15,161,101x14,103,30,158,101x14,103,45,160]}"
native7="2279,204x59,0,0{102x59,0,0[102x29,0,0,155,102x14,0,30,157,102x14,0,45,162],101x59,103,0[101x14,103,0,156,101x14,103,15,161,101x14,103,30,158,101x14,103,45,160]}"
native8="e68c,204x59,0,0{102x59,0,0[102x14,0,0,155,102x14,0,15,163,102x14,0,30,157,102x14,0,45,162],101x59,103,0[101x14,103,0,156,101x14,103,15,161,101x14,103,30,158,101x14,103,45,160]}"

thunderbolt1="a25f,364x101,0,0,142"
thunderbolt2="57e0,364x101,0,0{182x101,0,0,142,181x101,183,0,143}"
thunderbolt3="b144,364x101,0,0{120x101,0,0,150,120x101,121,0,151,122x101,242,0,152}"
thunderbolt4="60b8,364x101,0,0{90x101,0,0,142,90x101,91,0,145,90x101,182,0,143,91x101,273,0,144}"
thunderbolt5="f4c4,364x101,0,0{90x101,0,0,142,90x101,91,0,145,90x101,182,0,143,91x101,273,0[91x50,273,0,144,91x50,273,51,146]}"
thunderbolt6="35b4,364x101,0,0{90x101,0,0,142,90x101,91,0,145,90x101,182,0[90x50,182,0,143,90x50,182,51,147],91x101,273,0[91x50,273,0,144,91x50,273,51,146]}"
thunderbolt7="029d,364x101,0,0{90x101,0,0,142,90x101,91,0[90x50,91,0,145,90x50,91,51,148],90x101,182,0[90x50,182,0,143,90x50,182,51,147],91x101,273,0[91x50,273,0,144,91x50,273,51,146]}"
thunderbolt8="d87e,364x101,0,0{90x101,0,0[90x50,0,0,142,90x50,0,51,149],90x101,91,0[90x50,91,0,145,90x50,91,51,148],90x101,182,0[90x50,182,0,143,90x50,182,51,147],91x101,273,0[91x50,273,0,144,91x50,273,51,146]}"
thunderbolt9="26ad,364x101,0,0{90x101,0,0[90x50,0,0,142,90x50,0,51,149],90x101,91,0[90x50,91,0,145,90x50,91,51,148],90x101,182,0[90x50,182,0,143,90x50,182,51,147],91x101,273,0[91x50,273,0,144,91x25,273,51,146,91x24,273,77,153]}"
thunderbolt10="7b3f,364x101,0,0{90x101,0,0[90x50,0,0,142,90x50,0,51,149],90x101,91,0[90x50,91,0,145,90x50,91,51,148],90x101,182,0[90x50,182,0,143,90x50,182,51,147],91x101,273,0[91x25,273,0,144,91x24,273,26,154,91x25,273,51,146,91x24,273,77,153]}"
thunderbolt11="c683,364x101,0,0{90x101,0,0[90x50,0,0,64,90x50,0,51,71],90x101,91,0[90x50,91,0,65,90x50,91,51,70],90x101,182,0[90x50,182,0,66,90x25,182,51,69,90x24,182,77,74],91x101,273,0[91x25,273,0,67,91x24,273,26,73,91x25,273,51,68,91x24,273,77,72]}"
thunderbolt12="83cc,364x101,0,0{90x101,0,0[90x50,0,0,64,90x50,0,51,71],90x101,91,0[90x50,91,0,65,90x50,91,51,70],90x101,182,0[90x25,182,0,66,90x24,182,26,75,90x25,182,51,69,90x24,182,77,74],91x101,273,0[91x25,273,0,67,91x24,273,26,73,91x25,273,51,68,91x24,273,77,72]}"
thunderbolt13="3bf5,364x101,0,0{90x101,0,0[90x50,0,0,64,90x50,0,51,71],90x101,91,0[90x50,91,0,65,90x25,91,51,70,90x24,91,77,76],90x101,182,0[90x25,182,0,66,90x24,182,26,75,90x25,182,51,69,90x24,182,77,74],91x101,273,0[91x25,273,0,67,91x24,273,26,73,91x25,273,51,68,91x24,273,77,72]}"
thunderbolt14="2548,364x101,0,0{90x101,0,0[90x50,0,0,64,90x50,0,51,71],90x101,91,0[90x25,91,0,65,90x24,91,26,77,90x25,91,51,70,90x24,91,77,76],90x101,182,0[90x25,182,0,66,90x24,182,26,75,90x25,182,51,69,90x24,182,77,74],91x101,273,0[91x25,273,0,67,91x24,273,26,73,91x25,273,51,68,91x24,273,77,72]}"
thunderbolt15="323b,364x101,0,0{90x101,0,0[90x50,0,0,64,90x25,0,51,71,90x24,0,77,78],90x101,91,0[90x25,91,0,65,90x24,91,26,77,90x25,91,51,70,90x24,91,77,76],90x101,182,0[90x25,182,0,66,90x24,182,26,75,90x25,182,51,69,90x24,182,77,74],91x101,273,0[91x25,273,0,67,91x24,273,26,73,91x25,273,51,68,91x24,273,77,72]}"
thunderbolt16="fd6d,364x101,0,0{90x101,0,0[90x25,0,0,64,90x24,0,26,79,90x25,0,51,71,90x24,0,77,78],90x101,91,0[90x25,91,0,65,90x24,91,26,77,90x25,91,51,70,90x24,91,77,76],90x101,182,0[90x25,182,0,66,90x24,182,26,75,90x25,182,51,69,90x24,182,77,74],91x101,273,0[91x25,273,0,67,91x24,273,26,73,91x25,273,51,68,91x24,273,77,72]}"

layout() {
  if (( width < 220 )); then
    case $panes in
      1) echo $native1 ;;
      2) echo $native2 ;;
      3) echo $native3 ;;
      4) echo $native4 ;;
      5) echo $native5 ;;
      6) echo $native6 ;;
      7) echo $native7 ;;
      8) echo $native8 ;;
      *) echo "tiled" ;;
    esac
  elif (( width > 350 )); then
    case $panes in
      1) echo $thunderbolt1 ;;
      2) echo $thunderbolt2 ;;
      3) echo $thunderbolt3 ;;
      4) echo $thunderbolt4 ;;
      5) echo $thunderbolt5 ;;
      6) echo $thunderbolt6 ;;
      7) echo $thunderbolt7 ;;
      8) echo $thunderbolt8 ;;
      9) echo $thunderbolt9 ;;
      10) echo $thunderbolt10 ;;
      11) echo $thunderbolt11 ;;
      12) echo $thunderbolt12 ;;
      13) echo $thunderbolt13 ;;
      14) echo $thunderbolt14 ;;
      15) echo $thunderbolt15 ;;
      16) echo $thunderbolt16 ;;
      *) echo "tiled" ;;
    esac
  else
    echo "tiled"
  fi
}

tmux select-layout "$(layout)"
